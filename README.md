# Malware-Catcher
Assingment API

Technology Stack:
Java 11
Spring Boot Project v.2.5.6
Maven 4.0
H2 in-memory database
Dozer Mapper v.6.5.2
Lombok
Swagger 3.0
JUnit
Mockito


Run the application:
./mvnw spring-boot:run

Port : 8090


Controller (MalwareDetectorRestController) receive web service requests.
As a entity scructure, DeviceData have a list of DetectionData. Also DetectionData have a DeviceData, connected with device_data_scan_id. There is one-to-many relationship.
Program has 2 Rest web servises; /store and /retrieve

# /store
Request comes to MalwareDetectorStoreService class.
Firstly dozer maps MalwareDetectorStoreRequestDto object to Entity object: DeviceData & DetectionData.
Validation methods checks request variables, device teype and detection type. If validation fail ws throws an exception and return HTTP 500 error.
DeviceDataRepository and DetectionDataRepository stores their new datas with save method.

# /retrieve
Request comes to MalwareDetectorRetrieveService class.
Request parameter's type is RetrieveRequestDto and there is no need to validate it. If it's null it's mean no specific search parameter.
RetrieveRequestSpecificationsBuilder builds dynamic specification to findAll method.
In SearchCriteria, isOrOperation variable means like OR to where condition. The ws all isOrOperation's are false, because ws checks all search parameters in the same time (AND).
In SearchCriteria, isDeviceParam variable means the search parameter is in detection or in nested object device.
After get all requested data from db, change it to MalwareDetectorResponseDto type, then sort it as most recent detection at top.


Test Cases:
MalwareDetectAndStoreInvalidTests & MalwareDetectAndStoreValidTests classes have multiple test cases to test store detection data.


TODO's
detectionTime in DetectionData class is Long type right now. It's for epoch timestamp. If we want to change type to java.sql.Timestamp then we need to add ".directModelSubstitute(Timestamp.class, Long.class)" to SwaggerConfiguration.
Test cases will write to MalwareRetrieveTests class.
